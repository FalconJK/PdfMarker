# PDF書籤批量添加工具

這是一個用Python編寫的工具，可以幫助您為PDF文件批量添加多層級書籤。無論是電子書、論文還是技術文檔，這個工具都能幫助您快速添加結構化的書籤，使導航更加便捷。

## 功能特點

- 支持多層級書籤結構
- 可設置頁碼偏移，解決目錄頁碼與PDF實際頁碼不一致的問題
- 支持UTF-8編碼，完美支持中文和其他語言
- 自動檢查並處理超出範圍的頁碼
- 保留原PDF的所有內容，僅添加書籤

## 安裝需求

1. Python 3.6+
2. PyPDF2 庫

```bash
pip install PyPDF2
```

## 使用方法

### 步驟 1: 準備書籤數據文件

創建一個文本文件（例如 `bookmark_data.txt`），按照以下格式編寫書籤數據：

```
# 格式: 層級 標題 頁碼
1 第一章 簡介 1
2 1.1 背景 2
2 1.2 目的 3
1 第二章 理論基礎 5
```

- 每行一個書籤
- 每行格式為：`層級 標題 頁碼`
- 層級數字表示書籤的層級（1為頂層書籤，2為二級書籤，以此類推）
- 標題可以包含空格
- 頁碼必須是整數，對應PDF中顯示的頁碼

### 步驟 2: 運行腳本

```bash
python pdf_bookmark_tool.py 輸入PDF文件路徑 輸出PDF文件路徑 書籤數據文件路徑 [頁碼偏移]
```

參數說明：
- `輸入PDF文件路徑`: 原始PDF文件的路徑
- `輸出PDF文件路徑`: 添加書籤後的PDF文件保存路徑
- `書籤數據文件路徑`: 書籤數據文件的路徑
- `頁碼偏移`（可選）: 目錄頁碼與PDF實際頁碼的差值

例如：
```bash
python pdf_bookmark_tool.py input.pdf output.pdf bookmark_data.txt 4
```

這表示如果目錄中標記為第1頁的內容實際位於PDF的第5頁，則偏移值為4。

## 快速入門示例

### 示例書籤數據文件 (bookmark_example.txt)

```
# 書籤數據文件示例
# 格式: 層級 標題 頁碼
1 第一章 簡介 1
2 1.1 背景 2
2 1.2 目的 3
1 第二章 理論基礎 5
2 2.1 基本概念 6
3 2.1.1 定義 7
3 2.1.2 原理 8
2 2.2 應用範圍 10
1 第三章 方法論 12
2 3.1 研究方法 13
2 3.2 數據分析 15
1 第四章 結論 20
```

### 運行命令

```bash
python pdf_bookmark_tool.py document.pdf document_with_bookmarks.pdf bookmark_example.txt
```

如果PDF文件有頁碼偏移（例如封面、前言等內容），可以添加偏移值：

```bash
python pdf_bookmark_tool.py document.pdf document_with_bookmarks.pdf bookmark_example.txt 2
```

## 使用AI輔助生成書籤數據

您可以使用AI（如ChatGPT）來幫助您生成書籤數據文件：

1. 將PDF的目錄頁面截圖或複製目錄文本
2. 向AI提供以下指令：
   ```
   根據以下格式，幫我將這個目錄轉換為書籤數據文件：
   # 格式: 層級 標題 頁碼
   1 第一章 簡介 1
   2 1.1 背景 2
   ```
3. 將AI生成的內容保存為文本文件（例如 `bookmark_data.txt`）
4. 使用生成的書籤數據文件運行腳本

## 常見問題

### 頁碼不一致問題

如果PDF文件的實際頁碼與目錄中的頁碼不一致（例如PDF包含封面、目錄等內容），您可以使用頁碼偏移參數來解決這個問題。

例如，如果目錄中標記為第1頁的內容實際位於PDF的第5頁，則偏移值為4：
```bash
python pdf_bookmark_tool.py input.pdf output.pdf bookmark_data.txt 4
```

### 書籤不顯示或顯示在錯誤頁面

- 檢查書籤數據文件的格式是否正確
- 確認頁碼偏移值是否設置正確
- 確保PDF文件沒有加密或其他限制

### 中文顯示亂碼

- 確保書籤數據文件使用UTF-8編碼保存
- 如果使用Windows記事本，保存時選擇"UTF-8"編碼

## 注意事項

1. 備份原始PDF文件，以防意外情況
2. 檢查生成的PDF文件，確保書籤正確添加
3. 頁碼應該是PDF顯示的頁碼，而不是PDF內部頁碼（內部頁碼從0開始）

## 許可證

MIT License